"use strict";function GetIP(n){$.ajax({method:"GET",dataType:"json",url:"http://ip-api.com/json",success:function(t){var i=t.countryCode;i!=="IR"&&$(n).html("<p class='alert alert-warning ' >دانلود فقط با IP ایران امکان پذیر است<\/p>")}})}function ScroolSet(){var n=$("#mainMenu");$(document).scrollTop()>=110?(n.addClass("fixedNav"),$("#bigLogo").slideUp().hide(),$("#logo").removeAttr("style")):(n.removeClass("fixedNav"),$("#bigLogo").slideDown(),$("#logo").attr("style","visibility:hidden !important"))}function color(n){var t=Number(n).toString(16);return"#"+("000000".substr(0,6-t.length)+t.toUpperCase())}function isDark(n){var t=/rgb\((\d+).*?(\d+).*?(\d+)\)/.exec(n);return parseFloat(t[1])+parseFloat(t[2])+parseFloat(t[3])<384}function setBoxSize(n){$(n).height()<96&&($(n).css("line-height","96px"),$(n).css("height","96px"));$(n).height()>96&&$(n).height()<288&&($(n).css("line-height","48px"),$(n).css("height","96px"));$(n).height()>=288&&$(n).css("line-height","32px")}function doResize(n){var r,t,i;for($(".titleBoxArea").each(function(n,t){setBoxSize(t)}),$(".caption").each(function(n,t){$(t).css("height","auto")}),r=$(".caption").length,t=0;t<r;t+=n)i=0,$(".caption").slice(t,t+n).each(function(n,t){$(t).height()>i&&(i=$(t).height())}),$(".caption").slice(t,t+n).each(function(n,t){$(t).height(i)})}function autoComplatetxt(n,t,i){$(n).autocomplete({source:function(n,t){$.ajax({url:i,dataType:"json",type:"Get",contentType:"application/json; charset=utf-8",data:{keyref:JSON.stringify(n.term)},success:function(n){t($.map(n.d,function(n){return{label:n.split("-")[0],val:n.split("-")[1]}}))},error:function(n,t){alert(t)}})},position:{my:"right top",at:"right bottom"},open:function(){var t=$(n).width();$(n).autocomplete("widget").width(t)},minLength:2,select:function(n,i){var u=i.item,r=$("#"+t);r.val(i.item.val)}})}function scroolerTo(n){$("html, body").animate({scrollTop:$(n).offset().top-200},1e3)}function loadRating(){$(".basic").jRating({bigStarsPath:"/content/icons/stars.png",smallStarsPath:"/content/icons/small.png",rateMax:5,step:!0,length:5,onSuccess:function(n,t){$("#Value").val(t);$(".jRatingAverage").attr("style","width: 0px; top: -20px;");$(".btn-save-vote").trigger("click")}})}function loadRatingJustForShow(){$(".basic").jRating({bigStarsPath:"/content/icons/stars-white.png",smallStarsPath:"/content/icons/small.png",rateMax:5,step:!0,length:5,isDisabled:!0,type:"big"})}var isMobile,main;$(function(){function t(n){dc.query(n)&&alert("found "+n)}function i(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)===" ";)t=t.substring(1);if(t.indexOf(r)===0)return t.substring(r.length,t.length)}return""}function u(){var t=i("CloseC"),r,n,f,u;for(t!==""&&$(t).collapse("hide"),r=t.split(","),n=0;n<r.length;n++)f=r[n].replace("#",""),u=$("[data-ico='"+f+"']"),$(u).removeClass("fa-minus-square-o"),$(u).addClass("fa-plus-square-o")}function f(){var n=i("viewDta");n!==""&&$(n).attr("style","color:#660099 !important")}$(".btn-Login").click(function(){callModal.spinner(function(n){$.get("/CNTDL/DownloadFileModal",null,function(t){n().then(function(){callModal.notif(t,"loginModal")})})})});$(".btn-save-like").click(function(){var i=$(this).data("login"),r=$(this).data("title"),n,t;i=="False"?($.get("/CNTDL/DownloadFileModal",null,function(n){callModal.notif(n);$("#myModalTitle").html(r)}),$("#myModalTitle").html(result.message)):(n=$(this).data("url"),$("#frmlike > #Value").val($(this).data("val")),t=$("#frmlike").serialize(),$.ajax({url:n,dataType:"json",contentType:"application/json; charset=utf-8",data:t,success:function(n){n.status==="ok"?(console.log(n),$("#likeCount").html(n.data.Like),$(".btn-save-like").find(".fa-thumbs-up").remove(),$(".btn-save-like").find(".fa-heart").remove(),n.data.userLike==0?n.data.useHeart?$(".btn-save-like").append("<i class='far fa-heart' ><\/i>"):$(".btn-save-like").append("<i class='far fa-thumbs-up' ><\/i>"):n.data.useHeart?$(".btn-save-like").append("<i class='fa fa-heart' ><\/i>"):$(".btn-save-like").append("<i class='fa fa-thumbs-up' ><\/i>")):$(function(){callModal.notif(n.message)})},error:function(n,t){callModal.notif(t)}}))});$(".modal-download").click(function(){var n=$(this).attr("data-action");$.get(n,null,function(n){callModal.notif(n);$("#myModalTitle").html("برای دانلود فایل ابتدا وارد شوید!")})});$(".btn-save-vote").click(function(){var i=$(this).data("login"),r=$(this).data("title"),n,t;i=="False"?$.get("/CNTDL/DownloadFileModal",null,function(n){callModal.notif(n);$("#myModalTitle").html(r)}):(n=$("#frmvoterank").serialize(),t=$(this).data("url"),$.ajax({url:t,dataType:"json",contentType:"application/json; charset=utf-8",data:n,success:function(n){callModal.notif(n.message);$("#VoteAverage").text(n.data);var t=$(".basic").clone();$("#rating").find(".basic").remove();$("#rating").append("<div class='basic' data-average="+n.data+" data-id='1'><\/div>");loadRating()},error:function(n,t){callModal.notif(t)}}))});t(".start i");t(".playfilmcourse");u();f();$(document).on("click","#btnResendVerify",function(){var n={iDSecond:$("#IDSecond").val()};$.post("/User/VerifyMobileCode",n,function(t){callModal.notif(t);$("input[tabindex=101]").focus();$.get("/User/GetTimerValue",n,function(n){r("resend",n)})})});$(document).on("keydown",".verifydigitbox",function(n){n.keyCode===8&&n.target.value===""&&$(this).prev().focus()});$(document).on("keyup","[data-verifyid]",function(n){var i="",r,t;if($("#ErrorMsg").text()!=""&&($("#secErrorMsg").addClass("collapse"),$("#ErrorMsg").text("")),$.isNumeric($(this).val())){for(r=parseInt($(this).attr("tabindex"))+1,$("input[tabindex="+r+"]").trigger("focus"),$("input[tabindex="+r+"]").trigger("select"),t=101;t<=105;t++)i=i+$("input[tabindex="+t+"]").val();i.length==5&&$("#btnConfirmVerify").trigger("click")}else $(this).val(""),n.stopPropagation(),n.preventDefault()});$(document).on("click","#btnConfirmVerify",function(){for(var n="",t=101;t<=105;t++)n=n+$("input[tabindex="+t+"]").val();n.length<5?($("#secErrorMsg").removeClass("collapse"),$("#ErrorMsg").text("کد ارسالی را وارد کنید")):(Data={ID:$("#IDSecond").val(),VerifyCode:n},$.post("/user/ConfirmVerify",Data,function(n){n.result.Error?($("#secErrorMsg").removeClass("collapse"),$("#ErrorMsg").text(n.ErrorMessage[0])):(closeModal(),$("#modal .content .modalFooter #optional").removeClass("active"),$("#btnConfirmVerify").hasClass("btnConfirmVerifyPersonalInfo")&&(window.location.href='/Userpanel/Profile?IsVerified="True"'),window.location.href=n.urlName=="ForgetPassword"?"/User/ChangePassword?idSeccond="+n.IDSeccond:n.returnUrl)}))});$(document).on("click","#btnActivateUser",function(){var n={email:$("#Email").val()};$.post("/User/VerifyMobileCode",n,function(t){console.log(t);callModal.notif(t);$("input[tabindex=101]").focus();$.get("/User/GetTimerValue",n,function(n){r("send",n)})})});var r=function(n,t){var i=t*1e3,r=setInterval(function(){i-=1e3;var u=Math.floor(i%(1e3*t)/1e3);$(".VerifyReminedTimer").html(" ارسال مجدد در "+u+" ثانیه دیگر ");i<=0?(clearInterval(r),n=="resend"?($("#secResendVerify").addClass("collapse"),$("#secResendVerify").removeClass("collapse.in"),$("#secVerifyReminedTimer").addClass("collapse.in"),$("#secVerifyReminedTimer").removeClass("collapse")):($("#secResendVerify").addClass("collapse.in"),$("#secResendVerify").removeClass("collapse"),$("#secVerifyReminedTimer").addClass("collapse"))):n=="resend"&&($("#secResendVerify").addClass("collapse"),$("#secResendVerify").removeClass("collapse.in"),$("#secVerifyReminedTimer").addClass("collapse.in"),$("#secVerifyReminedTimer").removeClass("collapse"))},1e3)},n=dc.query(".mainPageSection.Qcomment");n&&setTimeout(function(){function s(){var n=undefined;dc.queries(".mainPageSection.Qcomment section div .icon").forEach(function(t){if(t.dataset.user=="کاربر میهمان"){n=t.dataset.user;return}t.dataset.user===n&&t.parentElement.classList.add("combine");n=t.dataset.user})}function h(){dc.queries(".mainPageSection.Qcomment section i").forEach(function(n){n.addEventListener("click",function(n){var i=n.target.parentElement.parentElement.cloneNode(!0);t.query(".target").appendChild(i);t.classList.add("active")})})}function y(){i.querySelector("input#Title").value="";i.querySelector("textarea").value=""}function c(){t.classList.remove("active");t.addEventListener("transitionend",function(){t.query(".target").innerHTML="";t.query("p.success").classList.remove("show");t.query(".reply textarea").value="";t.queries(".validationMsg").forEach(function(n){n.classList.remove("show")})},{once:!0})}function l(t){if(t.length<6){if(t.length==0){n.classList.add("empty");return}n.classList.remove("empty");n.classList.add("minimal")}else n.classList.remove("empty"),n.classList.remove("minimal")}var i=dc.query(".mainPageSection.Qcomment form"),u=dc.query(".mainPageSection.Qcomment form p"),f=u.query("span"),e=dc.query(".mainPageSection.Qcomment section"),r=e.queries(".question, .answer"),t=dc.query(".mainPageSection.Qcomment .replyModal"),o=t.query("form p span"),a=t.query(".overlay"),v=dc.query(".mainPageSection.Qcomment .contain > div section");setValidations(i);h();dc.queries(".mainPageSection.Qcomment .formTab span").forEach(function(n){n.addEventListener("click",function(){var t;if(!n.classList.contains("active")){dc.query(".mainPageSection.Qcomment .forms").classList.toggle("q");dc.queries(".mainPageSection.Qcomment .formTab span").forEach(function(n){n.classList.toggle("active")});t=n.getAttribute("data-iscomment");$("#IsComment").val(t);var i=$("#SectionID").val(),u=$("#ResourceID").val(),f=JSON.stringify({isComment:t,sectionId:i,resourceId:u});$.ajax({dataType:"html",contentType:"application/json",type:"Post",url:"../../QComment/ViewComment",data:f,success:function(n){v.innerHTML=n;h();s();lazyLoadPics();r=e.queries(".question, .answer");l(r)}})}})});s();i.addEventListener("submit",function(n){var t=this;n.preventDefault();validateSection(i).then(function(){data=new FormData($(t)[0]);$.ajax({processData:!1,contentType:!1,type:"Post",url:"../../QComment/SendComment",data:data,success:function(n){n.HasError?f.innerHTML=n.Errors[0]:(f.innerHTML="پیام  شما با موفقیت ثبت شد و پس از تایید ادمین، نمایش/پاسخ داده خواهد شد.",y())}});u.classList.add("show")})["catch"](function(){callModal.fail("لطفا فرم را کامل کنید")})});a.addEventListener("click",c);t.query("i.fa-times").addEventListener("click",c);t.query("form").addEventListener("submit",function(n){var i=this;n.preventDefault();validateSection(t).then(function(){var n=t.query(".target > *").getAttribute("data-id");t.query("#PCommentID").value=n;t.query("#IsComment").value=$("#IsComment").val();data=new FormData($(i)[0]);$.ajax({processData:!1,contentType:!1,type:"Post",url:"../../QComment/SendAnswer",data:data,success:function(n){n.HasError?o.innerHTML=n.Errors[0]:(o.innerHTML="پاسخ  شما با موفقیت ثبت شد",location.reload())}});t.query("p.success").classList.add("show");t.query("textarea").value=""})});l(r)},400)});isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};main=function(){var t=$("#mainMenu"),n;$(document).scroll(function(){ScroolSet();$("#logo").hide()});$(window).resize(function(){var n=$(window).width();n>600&&t.show()});n=$("#btnMenu");n.click(function(){$(".firstLevelRoot").toggle()})};$(function(){$("#searchbtn").click(function(){var t=$("#MenuEdu_txtSearch").val(),n=$("#MenuEdu_txtSearch").attr("tabindex");n=n!==""?"/"+n:"/Search/";t!==""&&(window.location="/Forum"+n+t)})});