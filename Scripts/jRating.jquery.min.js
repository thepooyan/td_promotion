/************************************************************************
*************************************************************************
@Name :       	jRating - jQuery Plugin
@Revison :    	3.0
@Date : 		28/01/2013 
@Author:     	 ALPIXEL - (www.myjqueryplugins.com - www.alpixel.fr) 
@License :		 Open Source - MIT License : http://www.opensource.org/licenses/mit-license.php
**************************************************************************
*************************************************************************/
(function(n){n.fn.jRating=function(t){var i={bigStarsPath:"jquery/icons/stars.png",smallStarsPath:"jquery/icons/small.png",phpPath:"php/jRating.php",type:"big",step:!1,isDisabled:!1,showRateInfo:!0,canRateAgain:!1,length:5,decimalLength:0,rateMax:20,rateInfosX:-45,rateInfosY:5,nbRates:1,onSuccess:null,onError:null};if(this.length>0)return this.each(function(){function c(n){var i=parseFloat(n*100/s*r.rateMax/100),t;switch(r.decimalLength){case 1:t=Math.round(i*10)/10;break;case 2:t=Math.round(i*100)/100;break;case 3:t=Math.round(i*1e3)/1e3;break;default:t=Math.round(i*1)/1}return t}function k(){switch(r.type){case"small":f=12;e=10;h=r.smallStarsPath;break;default:f=23;e=20;h=r.bigStarsPath}}function l(n){return n?n.offsetLeft+l(n.offsetParent):0}var r=n.extend(i,t),u=0,f=0,e=0,h="",a=!1,v=0,y=r.nbRates,p;p=n(this).hasClass("jDisabled")||r.isDisabled?!0:!1;k();n(this).height(e);var o=parseFloat(n(this).attr("data-average")),w=parseInt(n(this).attr("data-id")),s=f*r.length,b=o/r.rateMax*s,d=n("<div>",{"class":"jRatingColor",css:{width:b}}).appendTo(n(this)),o=n("<div>",{"class":"jRatingAverage",css:{width:0,top:-e}}).appendTo(n(this)),g=n("<div>",{"class":"jStar",css:{width:s,height:e,top:-(e*2),background:"url("+h+") repeat-x"}}).appendTo(n(this));n(this).css({width:s,overflow:"hidden",zIndex:1,position:"relative"});p||n(this).unbind().bind({mouseenter:function(t){var i=l(this),u=t.pageX-i,f;r.showRateInfo&&(f=n("<p>",{"class":"jRatingInfos",html:c(u)+' <span class="maxRate">/ '+r.rateMax+"<\/span>",css:{top:t.pageY+r.rateInfosY,left:t.pageX+r.rateInfosX}}).appendTo("body").show())},mouseover:function(){n(this).css("cursor","pointer")},mouseout:function(){n(this).css("cursor","default");a?o.width(v):o.width(0)},mousemove:function(t){var e=l(this),i=t.pageX-e;u=r.step?Math.floor(i/f)*f+f:i;o.width(u);r.showRateInfo&&n("p.jRatingInfos").css({left:t.pageX+r.rateInfosX}).html(c(u)+' <span class="maxRate">/ '+r.rateMax+"<\/span>")},mouseleave:function(){n("p.jRatingInfos").remove()},click:function(t){var f=this,i;if(a=!0,v=u,y--,(!r.canRateAgain||parseInt(y)<=0)&&n(this).unbind().css("cursor","default").addClass("jDisabled"),r.showRateInfo&&n("p.jRatingInfos").fadeOut("fast",function(){n(this).remove()}),t.preventDefault(),i=c(u),o.width(u),n(".datasSent p").html("<strong>idBox : <\/strong>"+w+"<br /><strong>rate : <\/strong>"+i+"<br /><strong>action :<\/strong> rating"),n(".serverResponse p").html("<strong>Loading...<\/strong>"),r.onSuccess)r.onSuccess(f,i);if(r.onError)r.onError(f,i)}})})}})(jQuery);