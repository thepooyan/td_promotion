"use strict";$(function(){var n=function n(t){var r=t.split(/(?=\.|#|\{|\[)/),i=document.createElement(r[0]);return r.shift(),r.forEach(function(n){var t=n.substring(1);switch(n.charAt(0)){case".":i.classList.add(t);break;case"#":i.id=t;break;case"{":t=t.slice(0,-1);i.innerText=t;break;case"[":t=t.slice(0,-1);t=t.split("=");i.setAttribute(t[0],t[1])}}),i.addChild=function(){for(var r=arguments.length,u=Array(r),t=0;t<r;t++)u[t]=arguments[t];return u.forEach(function(t){typeof t=="string"&&i.appendChild(n(t));t.nodeName&&i.appendChild(t)}),i},i},t=dc.query("#comments");t&&function(){var i=t.query("form"),r=t.queries(".content button"),u=function(){i.reset()};i&&(i.onsubmit=function(n){n.preventDefault();validateSection(i).then(function(){var r=new FormData(n.target),t={},i;r.forEach(function(n,i){t[i]=n});i=n.target.dataset.url;fetch(i,{method:"post",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(n){if(!n.ok){callModal.fail("خطای سرور");console.log(n);return}callModal.success("نظر شما با موفقیت ثبت شد!");u()})})["catch"](function(){callModal.fail("لطفا عنوان و متن نظر را خالی نگذارید!")})});r.length&&r.forEach(function(t){t.onclick=function(){callModal.custom(function(i,r){var f=n("textarea");f.id="answer-message";var e=n("form.commentReplyForm").addChild("p{پاسخ خود را ثبت کنید}",f,"button{ثبت}"),o=t.dataset.pcommentid,s=t.dataset.url;e.dataset.url=s;e.dataset.pcommentid=o;e.onsubmit=function(n){n.preventDefault();var t=n.target[0].value,i=n.target.dataset.url,e=n.target.dataset.pcommentid,o={Text:t,PCommentID:e};if(f.value.trim()===""){f.classList.add("error");return}fetch(i,{method:"post",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(function(n){if(!n.ok){callModal.fail("خطای سرور");console.log(n);return}r().then(function(){callModal.success("نظر شما با موفقیت ثبت شد!")});u()})};i(e);setValidations()})}})}()});